<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="pt"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>FuncionarioDAO.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;ControlChefWeb&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">br.com.controlchefweb.dao</a> &gt; <span class="el_source">FuncionarioDAO.java</span></div><h1>FuncionarioDAO.java</h1><pre class="source lang-java linenums">package br.com.controlchefweb.dao;

import br.com.controlchefweb.entidade.Produto;
import br.com.controlchefweb.entidade.Funcionario;
import br.com.controlchefweb.util.FabricaConexao;
import br.com.controlchefweb.util.exception.ErroSistema;
import java.io.Serializable;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;

@ManagedBean(name = &quot;FuncionarioDAO&quot;)
@SessionScoped
<span class="fc" id="L20">public class FuncionarioDAO implements CrudDAO&lt;Funcionario&gt;, Serializable {</span>

    private static final long serialVersionUID = 1L;

    private final static String[] tipos;

    static {
<span class="fc" id="L27">        tipos = new String[2];</span>
<span class="fc" id="L28">        tipos[0] = &quot;Funcion√°rio&quot;;</span>
<span class="fc" id="L29">        tipos[1] = &quot;Gerente&quot;;</span>
<span class="fc" id="L30">    }</span>

    public List&lt;String&gt; getTipos() {
<span class="fc" id="L33">        return Arrays.asList(tipos);</span>
    }

    @Override
    public void salvar(Funcionario entidade) throws ErroSistema {
        try {
<span class="fc" id="L39">            Connection conexao = FabricaConexao.getConexao();</span>
            PreparedStatement ps;
<span class="nc bnc" id="L41" title="All 2 branches missed.">            if (entidade.getId() == null) {</span>
<span class="nc" id="L42">                ps = conexao.prepareStatement(&quot;INSERT INTO funcionario (nome,login,senha,tipo) VALUES (?,?,?,?)&quot;);</span>
            } else {
<span class="nc" id="L44">                ps = conexao.prepareStatement(&quot;update funcionario set nome=?,login=?, senha=?, tipo=? where id=?&quot;);</span>
<span class="nc" id="L45">                ps.setInt(5, entidade.getId());</span>
            }
<span class="nc" id="L47">            ps.setString(1, entidade.getNome());</span>
<span class="nc" id="L48">            ps.setString(2, entidade.getLogin());</span>
<span class="nc" id="L49">            ps.setString(3, entidade.getSenha());</span>
<span class="nc" id="L50">            ps.setString(4, entidade.getTipo());</span>
<span class="nc" id="L51">            ps.execute();</span>
<span class="nc" id="L52">            FabricaConexao.fecharConexao();</span>
<span class="nc" id="L53">        } catch (SQLException ex) {</span>
<span class="nc" id="L54">            throw new ErroSistema(&quot;Erro ao tentar salvar funcionario!&quot;, ex);</span>
<span class="nc" id="L55">        }</span>
<span class="nc" id="L56">    }</span>

    @Override
    public void deletar(Funcionario entidade) throws ErroSistema {
        try {
<span class="fc" id="L61">            Connection conexao = FabricaConexao.getConexao();</span>
            
<span class="fc" id="L63">            PreparedStatement ps0 = conexao.prepareStatement(&quot;update pedido set vendendor=? where vendendor=?&quot;);</span>
<span class="fc" id="L64">            ps0.setString(1,null);</span>
<span class="nc" id="L65">            ps0.setInt(2,entidade.getId());</span>
<span class="nc" id="L66">            ps0.execute();</span>
            
<span class="nc" id="L68">            PreparedStatement ps = conexao.prepareStatement(&quot;delete from funcionario where id = ?&quot;);</span>
<span class="nc" id="L69">            ps.setInt(1, entidade.getId());</span>
<span class="nc" id="L70">            ps.execute();</span>
<span class="nc" id="L71">        } catch (SQLException ex) {</span>
<span class="nc" id="L72">            throw new ErroSistema(&quot;Erro ao deletar funcionario!&quot;, ex);</span>
<span class="nc" id="L73">        }</span>
<span class="nc" id="L74">    }</span>

    @Override
    public List&lt;Funcionario&gt; buscar() throws ErroSistema {
        try {
<span class="fc" id="L79">            Connection conexao = FabricaConexao.getConexao();</span>
<span class="fc" id="L80">            PreparedStatement ps = conexao.prepareStatement(&quot;select * from funcionario&quot;);</span>
<span class="fc" id="L81">            ResultSet resultSet = ps.executeQuery();</span>
<span class="fc" id="L82">            List&lt;Funcionario&gt; usuarios = new ArrayList&lt;&gt;();</span>
<span class="fc bfc" id="L83" title="All 2 branches covered.">            while (resultSet.next()) {</span>
<span class="fc" id="L84">                Funcionario usuario = new Funcionario();</span>
<span class="fc" id="L85">                usuario.setId(resultSet.getInt(&quot;id&quot;));</span>
<span class="fc" id="L86">                usuario.setNome(resultSet.getString(&quot;nome&quot;));</span>
<span class="fc" id="L87">                usuario.setLogin(resultSet.getString(&quot;login&quot;));</span>
<span class="fc" id="L88">                usuario.setSenha(resultSet.getString(&quot;senha&quot;));</span>
<span class="fc" id="L89">                usuario.setTipo(resultSet.getString(&quot;tipo&quot;));</span>
<span class="fc" id="L90">                usuarios.add(usuario);</span>
<span class="fc" id="L91">            }</span>
<span class="fc" id="L92">            FabricaConexao.fecharConexao();</span>
<span class="fc" id="L93">            return usuarios;</span>

<span class="nc" id="L95">        } catch (SQLException ex) {</span>
<span class="nc" id="L96">            throw new ErroSistema(&quot;Erro ao buscar os funcionarios!&quot;, ex);</span>
        }
    }

    public Funcionario buscarAunt(String login, String senha) throws ErroSistema {
        try {
<span class="fc" id="L102">            Connection conexao = FabricaConexao.getConexao();</span>
<span class="fc" id="L103">            PreparedStatement ps = conexao.prepareStatement(&quot;SELECT id,nome, login, senha, tipo FROM funcionario WHERE login=? AND senha=?&quot;);</span>
<span class="fc" id="L104">            ps.setString(1, login);</span>
<span class="fc" id="L105">            ps.setString(2, senha);</span>
<span class="fc" id="L106">            ResultSet resultSet = ps.executeQuery();</span>
<span class="fc" id="L107">            Funcionario usuario = new Funcionario();</span>
<span class="pc bpc" id="L108" title="1 of 2 branches missed.">            if (resultSet.next()) {</span>
<span class="nc" id="L109">                usuario.setId(resultSet.getInt(&quot;id&quot;));</span>
<span class="nc" id="L110">                usuario.setNome(resultSet.getString(&quot;nome&quot;));</span>
<span class="nc" id="L111">                usuario.setLogin(resultSet.getString(&quot;login&quot;));</span>
<span class="nc" id="L112">                usuario.setSenha(resultSet.getString(&quot;senha&quot;));</span>
<span class="nc" id="L113">                usuario.setTipo(resultSet.getString(&quot;tipo&quot;));</span>
            } else {
<span class="fc" id="L115">                return null;</span>
            }
<span class="nc" id="L117">            FabricaConexao.fecharConexao();</span>
<span class="nc" id="L118">            return usuario;</span>

<span class="nc" id="L120">        } catch (SQLException ex) {</span>
<span class="nc" id="L121">            throw new ErroSistema(&quot;Erro ao buscar os funcionarios!&quot;, ex);</span>
        }
    }
    
    public Funcionario buscarID(Integer id) throws ErroSistema {
        try {
<span class="fc" id="L127">            Connection conexao = FabricaConexao.getConexao();</span>
<span class="fc" id="L128">            PreparedStatement ps = conexao.prepareStatement(&quot;SELECT id,nome, login, senha, tipo FROM funcionario WHERE id=?&quot;);</span>
<span class="fc" id="L129">            ps.setInt(1, id);</span>
<span class="fc" id="L130">            ResultSet resultSet = ps.executeQuery();</span>
<span class="fc" id="L131">            Funcionario usuario = new Funcionario();</span>
<span class="pc bpc" id="L132" title="1 of 2 branches missed.">            if (resultSet.next()) {</span>
<span class="nc" id="L133">                usuario.setId(resultSet.getInt(&quot;id&quot;));</span>
<span class="nc" id="L134">                usuario.setNome(resultSet.getString(&quot;nome&quot;));</span>
<span class="nc" id="L135">                usuario.setLogin(resultSet.getString(&quot;login&quot;));</span>
<span class="nc" id="L136">                usuario.setSenha(resultSet.getString(&quot;senha&quot;));</span>
<span class="nc" id="L137">                usuario.setTipo(resultSet.getString(&quot;tipo&quot;));</span>
            } else {
<span class="fc" id="L139">                return null;</span>
            }
<span class="nc" id="L141">            FabricaConexao.fecharConexao();</span>
<span class="nc" id="L142">            return usuario;</span>

<span class="nc" id="L144">        } catch (SQLException ex) {</span>
<span class="nc" id="L145">            throw new ErroSistema(&quot;Erro ao buscar os funcionarios!&quot;, ex);</span>
        }
    }
    
    public Funcionario buscarLogin(String login) throws ErroSistema {
        try {
<span class="fc" id="L151">            Connection conexao = FabricaConexao.getConexao();</span>
<span class="fc" id="L152">            PreparedStatement ps = conexao.prepareStatement(&quot;SELECT id,nome, login, senha, tipo FROM funcionario WHERE login=?&quot;);</span>
<span class="fc" id="L153">            ps.setString(1, login);</span>
<span class="fc" id="L154">            ResultSet resultSet = ps.executeQuery();</span>
<span class="fc" id="L155">            Funcionario usuario = new Funcionario();</span>
<span class="pc bpc" id="L156" title="1 of 2 branches missed.">            if (resultSet.next()) {</span>
<span class="nc" id="L157">                usuario.setId(resultSet.getInt(&quot;id&quot;));</span>
<span class="nc" id="L158">                usuario.setNome(resultSet.getString(&quot;nome&quot;));</span>
<span class="nc" id="L159">                usuario.setLogin(resultSet.getString(&quot;login&quot;));</span>
<span class="nc" id="L160">                usuario.setSenha(resultSet.getString(&quot;senha&quot;));</span>
<span class="nc" id="L161">                usuario.setTipo(resultSet.getString(&quot;tipo&quot;));</span>
            } else {
<span class="fc" id="L163">                return null;</span>
            }
<span class="nc" id="L165">            FabricaConexao.fecharConexao();</span>
<span class="nc" id="L166">            return usuario;</span>

<span class="nc" id="L168">        } catch (SQLException ex) {</span>
<span class="nc" id="L169">            throw new ErroSistema(&quot;Erro ao buscar os funcionarios!&quot;, ex);</span>
        }
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>